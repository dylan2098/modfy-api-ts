Enum core.order_status {
  "created"
  "accept_order"
  "shipping"
  "shipped"
  "completed"
  "canceled"
  "failed"
}

Enum core.us_status {
  "pending"
  "active"
  "block"

}

Enum core.payment_status {
  "paid"
  "not_paid"
}

Enum core.product_type {
  "normal"
  "master"
  "variant"
  "set"
}

Enum core.role {
  "system"
  "customer"
}

Enum core.billing {
  "basket"
  "order"
}

Enum core.inv_mode {
  "normal"
  "preorder"
}

Enum core.inv_status {
  "available"
  "out_of_stock"
}

// User & Customer
Table Users {
  us_id int [pk, increment] 
  us_uuid string
  us_email string
  us_password string
  us_first_name string
  us_last_name string
  us_phone_number string
  us_status smallint
  us_updated_at datetime
}

Table Roles {
  role_id int pk
  role_name string
  role_description string
}

Table Menus {
  menu_id int pk
  menu_name string
  menu_pid string
  menu_path string
}

Table UserRole {
  us_id int
  role_id int
}

Table RoleMenu {
  role_id int
  menu_id int
}


Table KeyTokens {
  us_id int
  refresh_token string
  private_key string
  public_key string
  refresh_token_used array_string
  date string
}


Table Customers {
  cus_id int [pk, increment]
  cus_gender int
  cus_birthday datetime
  cus_avatar string
}

Table Address {
  addr_id int
  addr_street string
  addr_zip_code string
  addr_city string
  addr_country string
}

Table AddressBooks {
  addr_id int
  cus_id int
  selected boolean
}

// Site config
table GroupsConfig {
  gconfig_id int [pk, increment]
  gconfig_name string
  gconfig_status boolean
}

table Config {
  config_id int  [pk, increment]
  gconfig_id int // group config_id
  config_key string
  config_value string
}

// service 
table Services {
  svc_id int [pk, increment]
  svc_name string
  svc_host string
  svc_username string
  svc_password string
  svc_port string
  svc_status smallint
}


// Catalog & category
Table Catalogs {
  catalog_id int [pk, increment]
  catalog_name varchar
  catalog_status smallint
  catalog_updated_at datetime
}


Table Categories {
  catalog_id int
  category_id int [pk, increment]
  category_name varchar
  category_status smallint
  category_updated_at datetime
}


//Product attributes
Table ProductAttributes{
  product_id int
  pattr_brand string
  pattr_color string
  pattr_size string
  pattr_model string
  pattr_type core.product_type
  pattr_image string
  pattr_images string
  pattr_short_description string
  pattr_long_description string
}


// Product
Table Product {
  product_id int [pk, increment]
  product_uuid string
  category_id int
  product_sku string
  product_name string
	product_allow_use_promotion boolean // Bật lên thì áp dụng giảm giá cho sản phẩm được
  tax_id int
  product_status smallint
  product_updated_at datetime
}


Table Inventory {
  inv_id int
  inv_stock int
  inv_mode core.inv_mode
  inv_expected_date date
  inv_status core.inv_status
}



Table ProductPrice { 
  product_id int [pk]
  gross_price float
  net_price float
  tax_id int
}


// ke thua tu product master
Table ProductVariants {
  product_master_id int
  product_variant_id int
}

// bao gom cac product trong 1 PDP
Table ProductSets {
  product_master_id int
  product_set_id int
}


Table Baskets {
  basket_id int
  billing_id int
  basket_total_gross_price float
  basket_total_net_price float
  basket_total_tax_price float
  basket_updated_at string
}

Table BasketItems {
  basket_id int // reference Basket
  basket_item_id int
  product_id int // reference productId
  product_quantity int
  product_net_price float
  product_gross_price float
  product_tax_price float
}



// Order
Table Orders {
  order_id int [pk, increment]
  order_uuid uuid
	order_status core.order_status
  order_total_gross_price float
  order_total_net_price float
  order_tax_price float
  order_expected_date_delivery date //guess customer give order
	order_cancel_reason string 
  order_created_at string
  order_updated_at string
}


Table Billings {
  billing_id int
  order_id int
  cus_uuid string
  cus_email string
	cus_first_name string
  cus_last_name string
  cus_phone_number string
  cus_shipping_address string
  billing_type core.billing
  cus_note text
}


Table OrderItems {
  order_item_id int
  order_id int
  product_id int
  product_quantity int
  product_net_price float
  product_gross_price float
  product_tax_price float
}

table PaymentMethods {
  pm_id int
  pm_name string
  pm_status smallint
}

table PaymentTransactions {
  payment_transaction_id int
  order_transaction_id uuid // tx......
  order_id int
  pm_id int
  payment_status core.payment_status
}



table Shippings {
  shipping_id int
  shipping_uuid string
  order_id int
  order_uuid string
  shipping_method string
  shipping_carrier string // hang van chuyen
  shipping_tracking_number string
  shipping_date string
}


table Tax {
  tax_id int
  tax_name string
  tax_value int
  tax_status smallint
}



// Table WishList {
//   wishListId int [pk]
//   customerId int
//   products array // list products id
// }



// Table Coupons {
//   id int [pk, increment]
//   codePrefix string
//   type int  // SINGLE_CODE - MULTIPLE_CODES - SYSTEM_CODES
//   redemptionLimitPerCode int // so luong doi ma
//   redemptionLimitPerCustomer int // so lan doi cho moi khach hang
//   redemptionLimitPerTimeFrame int // so lan doi cho moi khung thoi gian
//   redemptionLimitTimeFrame int // khung thoi gian bat dau va ket thuc cua ma doi thuong
//   status smallint
//   createdAt datetime
//   updatedAt datetime
// }


// Table Promotions {
//   id int [pk, increment]
//   combinablePromotions string
// 	conditionalDescription string
//   name string
//   rank int // muc do uu tien
//   description string
//   image string
//   exclusivity int 
//   // NO - Can be combined with any promotion.
//   // CLASS - Can't be combined with promotions of the same class.
//   // GLOBAL - Can't be combined with any promotion.
  
//   discountProducts json
//   discount json
//   promotionClass json
//   status smallint
// 	createdAt datetime
// 	updatedAt datetime
// }

// Table Reviews {
//   reviewId int
//   customerId int
//   productId int
//   reviewText text
//   reviewRating int
//   status smallint
// }

Ref: "public"."RoleMenu"."role_id" < "public"."UserRole"."role_id"

Ref: "public"."UserRole"."role_id" < "public"."Roles"."role_id"

Ref: "public"."RoleMenu"."menu_id" < "public"."Menus"."menu_id"

Ref: "public"."UserRole"."us_id" < "public"."Users"."us_id"

Ref: "public"."Customers"."cus_id" < "public"."Users"."us_id"

Ref: "public"."AddressBooks"."addr_id" < "public"."Address"."addr_id"

Ref: "public"."AddressBooks"."cus_id" < "public"."Customers"."cus_id"

Ref: "public"."Catalogs"."catalog_id" < "public"."Categories"."catalog_id"

Ref: "public"."GroupsConfig"."gconfig_id" < "public"."Config"."config_id"

Ref: "public"."Users"."us_id" < "public"."KeyTokens"."us_id"

Ref: "public"."Orders"."order_id" < "public"."OrderItems"."order_id"

Ref: "public"."Categories"."category_id" < "public"."Product"."category_id"

Ref: "public"."Product"."product_id" < "public"."ProductAttributes"."product_id"

Ref: "public"."Product"."product_id" < "public"."ProductSets"."product_master_id"

Ref: "public"."Product"."product_id" < "public"."ProductVariants"."product_master_id"

Ref: "public"."Product"."product_id" < "public"."ProductPrice"."product_id"

Ref: "public"."Product"."product_id" < "public"."Tax"."tax_id"

Ref: "public"."Product"."product_id" < "public"."Inventory"."inv_id"

Ref: "public"."Baskets"."basket_id" < "public"."BasketItems"."basket_id"

Ref: "public"."Orders"."order_id" < "public"."PaymentTransactions"."order_id"

Ref: "public"."PaymentTransactions"."pm_id" < "public"."PaymentMethods"."pm_id"

Ref: "public"."Orders"."order_id" < "public"."Shippings"."order_id"

Ref: "public"."Orders"."order_id" < "public"."Billings"."order_id"

Ref: "public"."Billings"."billing_id" < "public"."Baskets"."billing_id"